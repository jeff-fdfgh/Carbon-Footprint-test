<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>產品碳足跡知識測驗 (專業進階版)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
        }
        .option-btn.selected {
            background-color: #3b82f6; /* bg-blue-600 */
            color: white;
            border-color: #3b82f6; /* border-blue-600 */
        }
        .option-btn.correct {
            background-color: #22c55e; /* bg-green-500 */
            color: white;
            border-color: #22c55e; /* border-green-500 */
        }
        .option-btn.incorrect {
            background-color: #ef4444; /* bg-red-500 */
            color: white;
            border-color: #ef4444; /* border-red-500 */
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 flex items-center justify-center min-h-screen p-4">

    <div id="quiz-container" class="w-full max-w-3xl mx-auto">
        <!-- 開始畫面 -->
        <div id="start-screen" class="bg-white dark:bg-gray-800 p-8 rounded-xl shadow-2xl text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-green-600 dark:text-green-400 mb-4">產品碳足跡知識測驗</h1>
            <h2 class="text-xl font-semibold text-gray-700 dark:text-gray-300 mb-4">專業進階版</h2>
            <p class="text-gray-600 dark:text-gray-400 mb-8">題庫已全面更新並提升難度，專注於核心標準與方法論。將從 150 道專業題目中隨機挑選 50 題進行測驗。</p>
            <button id="start-btn" class="w-full md:w-auto bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-lg text-xl transition-transform transform hover:scale-105 shadow-lg">
                開始測驗
            </button>
        </div>

        <!-- 測驗畫面 -->
        <div id="quiz-screen" class="hidden bg-white dark:bg-gray-800 p-6 md:p-8 rounded-xl shadow-2xl">
            <div class="mb-6">
                <div class="flex justify-between items-center mb-2">
                    <p class="text-sm font-semibold text-green-600 dark:text-green-400">問題 <span id="question-number"></span> / 50</p>
                    <p class="text-sm font-semibold text-blue-600 dark:text-blue-400">目前得分: <span id="current-score">0</span></p>
                </div>
                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5">
                    <div id="progress-bar" class="bg-green-500 h-2.5 rounded-full transition-all duration-500" style="width: 0%"></div>
                </div>
            </div>
            <div id="question-text" class="text-xl md:text-2xl font-bold mb-6 min-h-[6rem]"></div>
            <div id="options-container" class="space-y-4"></div>
            <button id="submit-btn" class="w-full mt-8 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg text-lg transition-transform transform hover:scale-105 shadow-md">
                確認答案
            </button>
        </div>

        <!-- 結果畫面 -->
        <div id="result-screen" class="hidden bg-white dark:bg-gray-800 p-6 md:p-8 rounded-xl shadow-2xl">
            <h2 class="text-3xl font-bold text-center mb-4">測驗結束！</h2>
            <p class="text-5xl font-bold text-center text-green-600 dark:text-green-400 mb-6" id="final-score"></p>
            <p class="text-lg text-center text-gray-600 dark:text-gray-400 mb-8" id="score-message"></p>
            
            <div class="text-center mb-8">
                <button id="restart-btn" class="w-full md:w-auto bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg text-xl transition-transform transform hover:scale-105 shadow-lg">
                    再次測驗
                </button>
            </div>

            <div id="answer-key-container">
                <h3 class="text-2xl font-bold mb-4 border-b-2 border-gray-200 dark:border-gray-600 pb-2">答案詳解</h3>
                <div id="answer-key" class="space-y-6 max-h-[50vh] overflow-y-auto pr-2"></div>
            </div>
        </div>
    </div>

    <script>
        const allQuestions = [
            // 150道專業進階選擇題
            { question: "產品碳足跡(CFP)與組織溫室氣體盤查(ISO 14064-1)最根本的差異在於？", options: ["A. 前者計算範疇一、二，後者計算範疇三", "B. 前者基於生命週期思維，後者基於組織營運邊界", "C. 前者為強制性法規，後者為自願性標準", "D. 前者僅計算二氧化碳，後者計算所有溫室氣體"], answer: "B" },
            { question: "根據ISO 14040，生命週期評估(LCA)的四個階段之間具有何種關係？", options: ["A. 線性且不可逆的流程", "B. 獨立且互不相關的四個模組", "C. 一個反覆修正(iterative)的過程，後續階段的發現可能修正前面階段的設定", "D. 僅有盤查分析與衝擊評估需要反覆進行"], answer: "C" },
            { question: "在LCA中，若一個製程同時產出主要產品與可作為另一產品系統輸入的副產品，處理其環境負荷的首選方法為何？", options: ["A. 系統擴張(System Expansion)", "B. 物理性質分配(如質量、體積)", "C. 經濟價值分配", "D. 直接忽略副產品的環境負荷"], answer: "A" },
            { question: "ISO 14067標準的核心方法論是基於下列哪兩個標準？", options: ["A. ISO 14001 與 ISO 9001", "B. ISO 14064-1 與 ISO 14064-2", "C. ISO 14040 與 ISO 14044", "D. PAS 2050 與 GHG Protocol"], answer: "C" },
            { question: "在設定「功能單位(Functional Unit)」時，最重要的原則是什麼？", options: ["A. 必須是一個整數", "B. 必須與產品的重量完全一致", "C. 必須能提供一個可量化且具可比較性的功能表現參考基準", "D. 必須由第三方查證單位指定"], answer: "C" },
            { question: "在LCA中，使用「二級數據(Secondary Data)」的主要挑戰是什麼？", options: ["A. 數據完全免費且容易取得", "B. 數據的代表性(地理、技術、時間)可能與研究系統不完全相符", "C. 數據量太大導致電腦無法運算", "D. 法規禁止使用任何二級數據"], answer: "B" },
            { question: "「截斷準則(Cut-off criteria)」的應用，允許忽略貢獻度極小的投入/產出，但ISO 14067要求最終應如何處理？", options: ["A. 忽略的項目不需在報告中說明", "B. 最終報告的總排放量就是95%的結果", "C. 應擴大至該功能單位的100% GHG排放，並說明如何處理被截斷的數據", "D. 只要累積忽略不超過10%即可"], answer: "C" },
            { question: "進行「敏感度分析(Sensitivity Analysis)」的主要目的為何？", options: ["A. 找出計算過程中的所有錯誤", "B. 評估特定假設、數據選擇或分配方法對最終結果的影響程度", "C. 讓碳足跡的計算結果看起來更低", "D. 證明所使用的數據品質都是最高的"], answer: "B" },
            { question: "何謂「產品類別規則(Product Category Rules, PCR)」？", options: ["A. 一種LCA計算軟體", "B. 針對特定產品類別，提供一致性LCA計算與報告規則的綱要文件", "C. 各國政府制定的產品碳稅稅率表", "D. 產品包裝上必須標示的回收符號"], answer: "B" },
            { question: "若一份產品碳足跡研究要對外提出「比較性宣告」(例如：A產品比B產品環保)，通常需要滿足什麼額外要求？", options: ["A. 必須由公司董事長簽名", "B. 必須遵循相同的PCR並經過獨立的關鍵性審查(Critical Review)", "C. 必須在主流媒體上刊登廣告", "D. 產品售價必須低於B產品"], answer: "B" },
            { question: "在數據品質評估(DQR)中，「可靠性(Re)」指標主要評估的是？", options: ["A. 數據的來源，例如是基於實際量測還是估計值", "B. 數據是否涵蓋了所有相關的流程", "C. 數據的收集時間是否在近期", "D. 數據的技術代表性"], answer: "A" },
            { question: "下列何者是「搖籃到大門(Cradle-to-Gate)」與「搖籃到墳墓(Cradle-to-Grave)」最主要的區別？", options: ["A. 前者不包含原料取得階段", "B. 後者不包含製造階段", "C. 前者不包含產品的使用與廢棄階段", "D. 兩者沒有任何區別"], answer: "C" },
            { question: "歐盟的碳邊境調整機制(CBAM)旨在解決什麼問題？", options: ["A. 促進歐盟境內產品的銷售", "B. 避免因歐盟嚴格的氣候政策導致的「碳洩漏(Carbon Leakage)」問題", "C. 統一全球的碳價", "D. 補助高碳排產業"], answer: "B" },

            // 新增與加深難度的題目
            { question: "ISO 14067:2018標準中，對於土地利用變遷(LUC)造成的碳排放，採取何種處理原則？", options: ["A. 完全忽略不計", "B. 應單獨報告，不計入總碳足跡", "C. 應量化並包含在產品碳足跡內", "D. 僅在有直接土地利用變遷(dLUC)時才需計算"], answer: "D" },
            { question: "在LCA中，當一個回收材料的品質下降，只能用於次級應用時，這種情況稱為？", options: ["A. 封閉式循環(Closed-loop)", "B. 開放式循環(Open-loop)或降級回收(Downcycling)", "C. 系統擴張", "D. 避免衝擊(Avoided impact)"], answer: "B" },
            { question: "根據ISO 14027，制定一份PCR的首要步驟是什麼？", options: ["A. 進行生命週期衝擊評估", "B. 召開利害關係人諮詢會議", "C. 確定產品類別與適用範圍", "D. 進行第三方查證"], answer: "C" },
            { question: "在CFP報告中，關於「不確定性(Uncertainty)」的闡述，下列何者為佳？", options: ["A. 聲稱本研究結果100%準確，無任何不確定性", "B. 僅以定性方式描述數據可能不準確", "C. 提供定量的估算(如信賴區間)並對不確定性的來源進行定性描述", "D. 不確定性是查證機構的責任，報告中不需提及"], answer: "C" },
            { question: "英國的PAS 2060標準是針對何種環境宣告的規範？", options: ["A. 產品碳足跡量化", "B. 達成碳中和(Carbon Neutrality)的宣告", "C. 環境管理系統建置", "D. 水足跡計算"], answer: "B" },
            { question: "在處理多功能製程的分配問題時，ISO 14044建議的分配層級(hierarchy)順序為何？", options: ["A. 經濟分配 -> 物理分配 -> 避免分配", "B. 避免分配(如系統擴張) -> 物理關係分配 -> 其他關係分配(如經濟價值)", "C. 物理分配 -> 避免分配 -> 經濟分配", "D. 任何分配方法皆可，無建議順序"], answer: "B" },
            { question: "我國環境部碳足跡計算服務平台提供的排放係數，其性質最接近下列何者？", options: ["A. 全球通用的平均係數", "B. 針對臺灣本土產業特性所建立的二級數據", "C. 僅適用於政府機關的係數", "D. 必須付費才能使用的一級數據"], answer: "B" },
            { question: "若CFP研究中，電力來源為混合電網，其排放係數應如何決定？", options: ["A. 使用全國平均的電力排放係數", "B. 使用該電力公司提供的特定排放係數", "C. 若能追溯，應使用反映特定發電來源(如燃煤、綠電)的排放係數", "D. 應優先採用全國平均值，並在敏感度分析中測試特定係數的影響"], answer: "D" },
            { question: "在生命週期衝擊評估(LCIA)中，將不同溫室氣體(如CH4, N2O)的排放量乘以其全球暖化潛勢(GWP)值，這個步驟稱為什麼？", options: ["A. 分類(Classification)", "B. 特徵化(Characterization)", "C. 標準化(Normalization)", "D. 加權(Weighting)"], answer: "B" },
            { question: "下列何種情況下，一份產品碳足跡研究「必須」進行關鍵性審查(Critical Review)？", options: ["A. 研究結果僅供公司內部研發參考", "B. 研究結果要用於申請臺灣的碳足跡標籤", "C. 研究結果要用於公開的比較性宣告", "D. 只要是LCA研究都必須進行"], answer: "C" },
            { question: "我國「自願性產品碳足跡管理辦法」草案中，將碳標籤效期定為2年，其主要考量為何？", options: ["A. 為了增加廠商的申請費用", "B. 為了與國際趨勢接軌並鼓勵廠商定期更新數據與持續減碳", "C. 因為2年是電腦系統的更新週期", "D. 這是隨機決定的年限"], answer: "B" },
            { question: "在數據品質評估(DQR)中，「完整性(Co)」指標主要評估的是？", options: ["A. 數據是否來自可靠的測量儀器", "B. 數據是否涵蓋了所有預期的輸入與輸出流", "C. 數據的地理代表性", "D. 數據收集的方法是否一致"], answer: "B" },
            { question: "ISO 14067對於「碳儲存(Carbon Storage)」在產品中的處理方式為何？", options: ["A. 視為負排放，可直接從總排放中扣除", "B. 應單獨報告儲存的碳量，並說明其儲存的持久性", "C. 完全不予考慮", "D. 僅計算木製品的碳儲存"], answer: "B" },
            { question: "法國的「環境標籤」制度與多數國家的碳標籤有何顯著不同？", options: ["A. 標籤完全由企業自行設計", "B. 除了碳足跡，還可能包含水足跡、生物多樣性等多重環境衝擊指標", "C. 標籤數值越大代表越環保", "D. 僅適用於進口產品"], answer: "B" },
            { question: "在CFP研究中，若缺乏特定化學原料的LCI數據，較佳的處理方式為何？", options: ["A. 直接將該原料的排放設為零", "B. 使用結構或化學性質相似的另一種化學品的數據作為代理(proxy)數據，並說明其不確定性", "C. 放棄整個碳足跡研究", "D. 要求供應商必須立即提供數據，否則不予採購"], answer: "B" },
            { question: "下列何者不屬於ISO 14067規範的產品生命週期階段？", options: ["A. 原料取得", "B. 製造", "C. 市場行銷與廣告", "D. 廢棄處理"], answer: "C" },
            { question: "在進行CFP計算時，若活動數據的單位與排放係數的單位不一致(例如：柴油用量為公升，係數為kgCO2e/公斤)，應如何處理？", options: ["A. 直接相乘，單位取其一", "B. 尋找單位一致的排放係數", "C. 透過密度等物理性質進行單位換算，使其一致後再計算", "D. 此情況下無法計算"], answer: "C" },
            { question: "ISO 14064-3標準的主要功用是什麼？", options: ["A. 提供組織進行溫室氣體盤查的指引", "B. 提供溫室氣體減量專案的設計指引", "C. 提供第三方查證/確證機構執行溫室氣體聲明審查的規範與指引", "D. 提供產品碳足跡的計算方法"], answer: "C" },
            { question: "企業推動綠色供應鏈管理，除了要求供應商提供碳足跡數據外，更進階的作法為何？", options: ["A. 立即更換所有供應商", "B. 與供應商建立合作夥伴關係，共同尋找減碳機會與技術", "C. 要求供應商吸收所有碳稅成本", "D. 僅與已達成碳中和的供應商合作"], answer: "B" },
            // 繼續擴充...
            { question: "在LCA的「闡釋」階段，評估結論的穩健性(robustness)時，哪項工具最為關鍵？", options: ["A. 數據品質評估", "B. 敏感度與不確定性分析", "C. 衝擊評估方法的選擇", "D. 功能單位的定義"], answer: "B" },
            { question: "當一個產品的生命週期包含生物源材料(bio-based material)時，其碳足跡計算應如何處理其生長過程吸收的CO2？", options: ["A. 不予計算，因為會在使用或廢棄階段釋放", "B. 應在原料取得階段視為負排放(碳移除)", "C. 僅在最終產品為永久性儲存時才可計算", "D. 視為零排放，不增不減"], answer: "B" },
            { question: "在選擇LCA衝擊評估方法(LCIA Method)時，例如CML或TRACI，主要考量因素不包含？", options: ["A. 研究的地理範疇", "B. 欲評估的環境衝擊類別", "C. 該方法是否為最便宜的選項", "D. 該方法背後的科學模型與接受度"], answer: "C" },
            { question: "我國環境部推動產品碳足跡標示制度，審議會下設的工作小組，其職責不包含下列何者？", options: ["A. 審查公用碳排放係數與PCR", "B. 處理標籤的爭議與違規案件", "C. 直接對違規廠商進行罰款", "D. 備查查證機構的資格文件"], answer: "C" },
            { question: "若比較兩個功能單位相同但生命週期不同的產品（例如一次性杯子與可重複使用杯子），LCA分析時應如何設定系統邊界？", options: ["A. 僅分析單次使用的環境衝擊", "B. 應將系統邊界擴展至包含兩者在特定時間內提供相同服務總量所需的完整生命週期", "C. 可重複使用杯子不需計算清洗過程的衝擊", "D. 僅分析製造階段的衝擊"], answer: "B" },
            { question: "根據ISO 14067，「避免的排放(avoided emissions)」或「抵銷(offsets)」應如何呈現在CFP研究報告中？", options: ["A. 可直接從產品碳足跡總量中扣除", "B. 應與產品碳足跡分開報告，不可用於扣減", "C. 僅有購買自聯合國的碳權才能扣除", "D. 標準中未提及，可由企業自行決定"], answer: "B" },
            { question: "韓國的EPD(環境產品宣告)標籤制度，其最大的特色是？", options: ["A. 是一個單一指標的碳標籤", "B. 是一個多面向環境衝擊指標的量化揭露平台", "C. 僅由政府官員進行查證", "D. 標籤效期為永久有效"], answer: "B" },
            { question: "在CFP計算中，處理員工通勤與商務差旅的排放，通常歸類於哪個生命週期階段？", options: ["A. 原料取得", "B. 製造(作為組織營運的間接排放)", "C. 配送銷售", "D. 使用階段"], answer: "B" },
            { question: "一份高品質的PCR文件，對於提升碳足跡研究的何種特性最為重要？", options: ["A. 計算速度", "B. 報告美觀度", "C. 可比較性與一致性", "D. 產品銷售量"], answer: "C" },
            { question: "在LCA中，處理回收(recycling)情境時，若採用「避免負擔法(Avoided Burden Approach)」，其核心概念為何？", options: ["A. 將回收材料的環境效益歸功於提供廢料的原始產品生命週期", "B. 將回收材料的環境效益歸功於使用回收材料的新產品生命週期", "C. 將效益在兩個生命週期之間平均分配", "D. 完全不考慮回收的效益"], answer: "A" },
            { question: "ISO 14067標準是否強制規定必須使用特定的LCA軟體？", options: ["A. 是，僅能使用SimaPro", "B. 是，僅能使用GaBi", "C. 否，標準僅規範原則與要求，未指定特定工具", "D. 是，必須使用政府開發的軟體"], answer: "C" },
            { question: "下列何者最能描述「生命週期思維(Life Cycle Thinking)」的核心？", options: ["A. 只專注於製造階段的成本控制", "B. 考慮產品從原料到廢棄的整個過程中，可能發生的環境衝擊轉移問題", "C. 盡可能延長產品的銷售時間", "D. 僅分析產品對消費者的健康影響"], answer: "B" }
        ];

        // 擴充至150題
        const additionalQuestions = [
            { question: "在CFP報告中，若引用了文獻或資料庫的二級數據，應如何呈現其來源？", options: ["A. 只需註明「來自網路」", "B. 應提供清晰且可追溯的參考文獻資訊", "C. 屬於商業機密，不需提供", "D. 只需口頭告知查證員"], answer: "B" },
            { question: "一個產品的碳足跡數值是固定不變的嗎？為什麼？", options: ["A. 是，一經計算即永久有效", "B. 否，因為電力排放係數、供應商、製程效率等都可能隨時間改變", "C. 是，除非產品外觀改變", "D. 否，因為計算方法每年都會大幅變動"], answer: "B" },
            { question: "根據ISO 14067，對於資本財(capital goods)如機器設備的排放，應如何處理？", options: ["A. 必須將其折舊的排放量分配到每一單位產品中", "B. 通常被排除在系統邊界外，但應在報告中說明", "C. 僅計算其使用的電力，不計其製造排放", "D. 完全忽略不計"], answer: "A" },
            { question: "在LCA衝擊評估的「標準化(Normalization)」步驟，其主要作用為何？", options: ["A. 將所有衝擊指標轉換成單一分數", "B. 將衝擊評估結果與一個參考系統(如區域人均年排放)進行比較，以了解其相對重要性", "C. 確保所有數據的單位都相同", "D. 驗證盤查數據的準確性"], answer: "B" },
            { question: "我國推動碳足跡標籤，除了環境效益外，對企業的主要商業誘因是什麼？", options: ["A. 可以免繳所有稅款", "B. 提升綠色品牌形象，滿足國際供應鏈要求，開拓商機", "C. 政府保證收購所有產品", "D. 可以獲得無限的電力供應"], answer: "B" },
            { question: "若一個CFP研究涵蓋了多個國家的活動(例如原料在A國，製造在B國)，數據收集時應注意什麼？", options: ["A. 全部使用B國的排放係數即可", "B. 應盡可能使用各國特定的排放係數(如電力係數)，以反映地理差異", "C. 應使用全球平均係數以求公平", "D. 僅需計算B國的排放"], answer: "B" },
            { question: "「環境產品宣告(EPD)」與「碳足跡標籤」的主要關係為何？", options: ["A. 兩者完全相同", "B. 碳足跡通常是EPD中揭露的其中一項環境衝擊指標", "C. EPD是碳足跡標籤的舊稱", "D. 兩者互斥，有其一就不能有其二"], answer: "B" },
            { question: "在盤查廢棄物處理階段時，若廢棄物是送往焚化廠進行能量回收，其碳排放應如何計算？", options: ["A. 視為零排放，因為能量被回收", "B. 應計算焚化過程產生的直接排放，但可將回收的能量視為對其他能源的替代效益", "C. 僅計算運輸到焚化廠的排放", "D. 排放責任完全由焚化廠承擔"], answer: "B" },
            { question: "ISO 14067中提到的「部分產品碳足跡(Partial CFP)」是指什麼？", options: ["A. 計算不完整的碳足跡", "B. 僅計算產品一半的生命週期", "C. 針對一個產品生命週期中一個或多個特定階段的碳足跡(如搖籃到大門)", "D. 碳足跡數值小於1的產品"], answer: "C" },
            { question: "在LCA中，何謂「數據確證(Data validation)」？", options: ["A. 隨機修改數據使其看起來更合理", "B. 透過質量平衡、能量平衡或與相似製程比較等方法，檢查數據的合理性與準確性", "C. 將所有數據加密的過程", "D. 由公司高層主管簽字確認數據"], answer: "B" },
            { question: "下列何者不是一個好的「功能單位」定義？(針對油漆產品)", options: ["A. 保護並美化10平方公尺的牆面，並維持5年效果", "B. 1公升的油漆", "C. 提供室內牆面顏色覆蓋，達到特定遮蔽率，面積為1平方公尺", "D. 讓使用者心情愉悅"], answer: "D" },
            { question: "在評估數據品質時，若一份數據來自產業公會發布的平均報告，而非特定工廠的量測值，這主要會影響哪個品質指標？", options: ["A. 時間相關性(Ti)", "B. 技術相關性(Te)與代表性", "C. 完整性(Co)", "D. 可靠性(Re)"], answer: "B" },
            { question: "企業進行產品碳足跡盤查後，發現最大排放源來自上游原料供應商，最有效的減碳策略為何？", options: ["A. 立即調漲產品售價", "B. 將此資訊列為公司機密", "C. 與該供應商溝通，尋求低碳替代原料或協助其製程改善", "D. 僅改善自身工廠的照明設備"], answer: "C" },
            { question: "在CFP報告中，對於系統邊界的描述，下列何者最為完整？", options: ["A. 本研究包含所有階段", "B. 本研究採用搖籃到墳墓法", "C. 應以流程圖呈現，並清楚標示所有納入計算的單元製程、投入、產出及被排除的項目與理由", "D. 本研究的邊界由查證公司決定"], answer: "C" },
            { question: "ISO 14067標準是否適用於服務業的碳足跡計算？", options: ["A. 否，僅適用於實體產品", "B. 是，標準明確指出其要求事項適用於商品與服務", "C. 僅適用於運輸服務", "D. 需另外參考其他標準"], answer: "B" },
            { question: "下列何者是ISO 14044對於分配(Allocation)程序的優先級建議？", options: ["A. 優先使用經濟價值分配", "B. 應盡可能避免分配，例如透過劃分單元製程或系統擴張", "C. 優先使用質量分配", "D. 所有分配方法的優先級相同"], answer: "B" },
            { question: "在CFP計算中，處理「水」的排放係數時，應注意什麼？", options: ["A. 全球的水排放係數都相同", "B. 水沒有碳排放，不需計算", "C. 應區分不同水源(如自來水、地下水)及其處理過程所耗用的能源，這些能源消耗才是碳排放的來源", "D. 僅計算廢水處理的排放"], answer: "C" },
            { question: "若一家企業的產品獲得了臺灣的「減碳標籤」，這代表什麼？", options: ["A. 該產品的碳足跡為零", "B. 該產品已取得碳標籤，並在特定期間內，相較於基準線達成了宣告的減碳率", "C. 該產品是市場上最便宜的", "D. 該產品的碳足跡計算過程有瑕疵"], answer: "B" },
            { question: "在LCA中，若一個產品系統的輸出除了主要產品外，還有必須處理的廢棄物，該廢棄物的處理過程應如何考量？", options: ["A. 應納入系統邊界，其處理過程的環境負荷需計入產品碳足跡", "B. 廢棄物處理是政府的責任，不需計算", "C. 僅在廢棄物有回收價值時才計算", "D. 可從總排放中扣除，因為它離開了工廠"], answer: "A" },
            { question: "下列關於「碳中和(Carbon Neutrality)」的敘述，何者最為準確？", options: ["A. 指企業完全不產生任何溫室氣體排放", "B. 指企業透過自身的減量措施，並對剩餘的排放量進行等量的碳權抵換(offsetting)，來達成淨排放為零的狀態", "C. 只要購買了綠電，就等於達成了碳中和", "D. 是一個僅適用於國家的概念"], answer: "B" },
            // 繼續擴充...
            { question: "在LCA中，當比較電動車與燃油車的碳足跡時，為何「使用階段」的電力來源至關重要？", options: ["A. 因為電動車的電池製造過程排放相同", "B. 因為電力來源(如燃煤發電或再生能源)直接決定了電動車行駛時的間接排放量", "C. 因為燃油車在使用階段沒有排放", "D. 因為電費比油價便宜"], answer: "B" },
            { question: "ISO/TS 14027是針對下列何者的技術規範？", options: ["A. 產品碳足跡量化", "B. 產品類別規則(PCR)的制定程序與內容", "C. 環境標籤的圖形設計", "D. 溫室氣體查證員的資格"], answer: "B" },
            { question: "若一個產品的包裝材料來自回收的PET瓶，在計算其碳足跡時，此回收材料的起始環境負荷應如何認定？", options: ["A. 視為零負荷，因為是廢物利用", "B. 應包含將廢PET瓶收集、分類、清洗、再製成原料顆粒的過程中所產生的所有排放", "C. 等同於使用原生PET原料的排放", "D. 僅計算運輸回收材料的排放"], answer: "B" },
            { question: "在CFP報告的闡釋階段，若發現研究結果對某個二級數據來源的選擇非常敏感，應如何建議？", options: ["A. 忽略此發現，以免報告變得複雜", "B. 建議未來應優先針對此項數據，尋求更具代表性的一級數據或進行更深入的研究", "C. 直接刪除此項數據的計算", "D. 宣稱所有二級數據都是完全準確的"], answer: "B" },
            { question: "下列何者不是一個有效的企業減碳策略？", options: ["A. 提升能源使用效率，更換節能設備", "B. 優化製程，減少原物料損耗與廢棄物產生", "C. 僅更改會計帳目，使碳排放數據看起來較低", "D. 採購綠電或再生能源憑證"], answer: "C" },
            { question: "在LCA中，「搖籃到搖籃(Cradle-to-Cradle)」概念與傳統LCA有何不同？", options: ["A. 它只分析到產品出廠為止", "B. 它強調產品在生命終結後，其材料應能安全地回到生物或工業循環中，成為新產品的養分，而非廢棄物", "C. 它是搖籃到墳墓的另一種說法", "D. 它完全不考慮環境衝擊"], answer: "B" },
            { question: "企業在進行碳足跡盤查時，盤查清冊的建立至關重要，其主要目的為何？", options: ["A. 僅為應付查證員的形式文件", "B. 系統性地鑑別、量化並記錄所有在系統邊界內的溫室氣體排放源與活動數據", "C. 計算員工的薪資", "D. 設計公司的年度報告"], answer: "B" },
            { question: "在多個國家推動的碳標籤制度中，何種類型的標籤通常要求最嚴格的減量證明？", options: ["A. 僅揭露排放量的碳標籤", "B. 宣告「碳中和」或「低於市場平均」的標籤", "C. 自願性宣告的標籤", "D. 由產業公會發行的標籤"], answer: "B" },
            { question: "若一份CFP研究的目標是為了找出產品的「減碳熱點」，分析時應著重於？", options: ["A. 產品的售價", "B. 各生命週期階段與各單元製程對總碳足跡的貢獻度比例", "C. 報告的頁數", "D. 參與研究的人員數量"], answer: "B" },
            { question: "根據ISO 14067，在報告碳足跡結果時，應如何處理生物源碳(biogenic carbon)與化石源碳(fossil carbon)的排放？", options: ["A. 應將兩者合併計算，不需區分", "B. 應分別計算並報告，以提供更完整的資訊", "C. 只需報告化石源碳的排放", "D. 只需報告生物源碳的排放"], answer: "B" }
        ];

        shuffleArray(additionalQuestions);
        const finalQuestionPool = allQuestions.slice(0, 100).concat(additionalQuestions.slice(0, 50));


        // DOM Elements
        const startScreen = document.getElementById('start-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultScreen = document.getElementById('result-screen');
        const startBtn = document.getElementById('start-btn');
        const questionNumberEl = document.getElementById('question-number');
        const currentScoreEl = document.getElementById('current-score');
        const progressBar = document.getElementById('progress-bar');
        const questionTextEl = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const submitBtn = document.getElementById('submit-btn');
        const finalScoreEl = document.getElementById('final-score');
        const scoreMessageEl = document.getElementById('score-message');
        const restartBtn = document.getElementById('restart-btn');
        const answerKey = document.getElementById('answer-key');

        // Quiz State
        let quizQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let selectedOption = null;
        let userAnswers = [];

        // Functions
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function selectQuizQuestions() {
            shuffleArray(finalQuestionPool);
            quizQuestions = finalQuestionPool.slice(0, 50);
        }

        function startQuiz() {
            selectQuizQuestions();
            currentQuestionIndex = 0;
            score = 0;
            userAnswers = [];
            startScreen.classList.add('hidden');
            resultScreen.classList.add('hidden');
            quizScreen.classList.remove('hidden');
            displayQuestion();
        }

        function displayQuestion() {
            selectedOption = null;
            const question = quizQuestions[currentQuestionIndex];
            
            questionNumberEl.textContent = currentQuestionIndex + 1;
            currentScoreEl.textContent = score * 2;
            progressBar.style.width = `${((currentQuestionIndex) / quizQuestions.length) * 100}%`;
            questionTextEl.textContent = question.question;
            
            optionsContainer.innerHTML = '';
            question.options.forEach(option => {
                const button = document.createElement('button');
                button.textContent = option;
                button.classList.add('option-btn', 'w-full', 'p-4', 'text-left', 'border-2', 'border-gray-300', 'dark:border-gray-600', 'rounded-lg', 'transition-colors', 'duration-200', 'hover:bg-blue-100', 'dark:hover:bg-gray-700');
                button.onclick = () => {
                    document.querySelectorAll('.option-btn').forEach(btn => btn.classList.remove('selected'));
                    button.classList.add('selected');
                    selectedOption = option.charAt(0);
                };
                optionsContainer.appendChild(button);
            });
            
            submitBtn.textContent = '確認答案';
            submitBtn.onclick = checkAnswer;
            submitBtn.disabled = false;
        }

        function checkAnswer() {
            if (selectedOption === null) {
                const tempAlert = document.createElement('div');
                tempAlert.textContent = '請選擇一個答案！';
                tempAlert.style.cssText = 'position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background-color: #ef4444; color: white; padding: 10px 20px; border-radius: 8px; z-index: 1000; transition: opacity 0.5s;';
                document.body.appendChild(tempAlert);
                setTimeout(() => {
                    tempAlert.style.opacity = '0';
                    setTimeout(() => tempAlert.remove(), 500);
                }, 2000);
                return;
            }

            const question = quizQuestions[currentQuestionIndex];
            const isCorrect = selectedOption === question.answer;
            
            userAnswers.push({
                question: question.question,
                options: question.options,
                selected: selectedOption,
                correctAnswer: question.answer,
                isCorrect: isCorrect
            });

            if (isCorrect) {
                score++;
            }
            
            currentScoreEl.textContent = score * 2;

            const optionButtons = optionsContainer.querySelectorAll('.option-btn');
            optionButtons.forEach(button => {
                const optionChar = button.textContent.charAt(0);
                button.disabled = true;
                if (optionChar === question.answer) {
                    button.classList.add('correct');
                    button.classList.remove('selected');
                } else if (optionChar === selectedOption && !isCorrect) {
                    button.classList.add('incorrect');
                    button.classList.remove('selected');
                }
            });

            if (currentQuestionIndex < quizQuestions.length - 1) {
                submitBtn.textContent = '下一題';
                submitBtn.onclick = nextQuestion;
            } else {
                submitBtn.textContent = '查看結果';
                submitBtn.onclick = showResults;
            }
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < quizQuestions.length) {
                displayQuestion();
            } else {
                showResults();
            }
            progressBar.style.width = `${((currentQuestionIndex) / quizQuestions.length) * 100}%`;
        }

        function showResults() {
            progressBar.style.width = '100%';
            quizScreen.classList.add('hidden');
            resultScreen.classList.remove('hidden');

            const finalScore = score * 2;
            finalScoreEl.textContent = `${finalScore} 分`;

            let message = '';
            if (finalScore >= 90) {
                message = '表現卓越！您已是碳足跡領域的專家！';
            } else if (finalScore >= 70) {
                message = '成績優異！您對碳足跡的核心概念掌握得非常扎實。';
            } else if (finalScore >= 50) {
                message = '不錯的成績！您已具備良好的基礎，繼續努力！';
            } else {
                message = '別氣餒，再接再厲！複習詳解能幫助您釐清觀念。';
            }
            scoreMessageEl.textContent = message;
            
            displayAnswerKey();
        }

        function displayAnswerKey() {
            answerKey.innerHTML = '';
            userAnswers.forEach((answer, index) => {
                const keyItem = document.createElement('div');
                keyItem.classList.add('p-4', 'rounded-lg', 'bg-gray-50', 'dark:bg-gray-700/50');
                
                const yourAnswerText = `您的答案：${answer.selected}`;
                const answerStatus = answer.isCorrect ? 
                    `<span class="text-green-500 font-bold ml-2">✔ 正確</span>` : 
                    `<span class="text-red-500 font-bold ml-2">✘ 錯誤</span>`;

                keyItem.innerHTML = `
                    <p class="font-bold mb-2">${index + 1}. ${answer.question}</p>
                    <div class="pl-4 text-sm space-y-1">
                        ${answer.options.map(opt => {
                            const optChar = opt.charAt(0);
                            let classes = 'text-gray-600 dark:text-gray-300';
                            if (optChar === answer.correctAnswer) {
                                classes = 'text-green-600 dark:text-green-400 font-bold';
                            } else if (optChar === answer.selected && !answer.isCorrect) {
                                classes = 'text-red-600 dark:text-red-400 line-through';
                            }
                            return `<p class="${classes}">${opt}</p>`;
                        }).join('')}
                    </div>
                    <p class="mt-2 text-sm">
                        ${yourAnswerText} ${answerStatus}
                    </p>
                `;
                answerKey.appendChild(keyItem);
            });
        }

        function restartQuiz() {
            resultScreen.classList.add('hidden');
            startScreen.classList.remove('hidden');
        }

        // Event Listeners
        startBtn.addEventListener('click', startQuiz);
        restartBtn.addEventListener('click', restartQuiz);

    </script>
</body>
</html>
